# 系统架构设计师学习辅助平台 - 开发环境

## 🚀 热更新功能

已配置前后端热更新功能，代码修改后会自动重新加载，无需手动重启服务。

## 📁 目录结构

```
学习辅助/
├── app/
│   ├── backend/          # 后端代码 (FastAPI + Python)
│   └── frontend/         # 前端代码 (Vue3 + TypeScript)
├── docker-compose.yml    # Docker编排配置
├── Dockerfile           # 后端Docker文件
└── dev-*.bat           # 开发环境脚本
```

## 🛠️ 开发环境启动

### 方式1: 使用脚本 (推荐)

```bash
# Windows用户
dev-start.bat      # 首次启动或完全重新构建
dev-restart.bat    # 快速重启服务
dev-stop.bat       # 停止所有服务
```

### 方式2: 手动命令

```bash
# 首次启动或重新构建
docker-compose down
docker-compose up --build

# 后台运行
docker-compose up -d

# 停止服务
docker-compose down
```

## 🔧 热更新机制

### 前端热更新 (Vue3 + Vite)
- **触发条件**: 修改 `app/frontend/src/` 下的任何文件
- **更新范围**: Vue组件、TypeScript、CSS、JSON配置
- **生效时间**: 1-3秒
- **浏览器**: 自动刷新页面

### 后端热更新 (FastAPI + Uvicorn)
- **触发条件**: 修改 `app/backend/` 下的任何 `.py` 文件
- **更新范围**: API路由、业务逻辑、数据模型
- **生效时间**: 2-5秒
- **API**: 自动重启应用

## 🌐 访问地址

- **前端应用**: http://localhost:3000
- **后端API**: http://localhost:8080
- **API文档**: http://localhost:8080/docs
- **数据库**: localhost:5432 (PostgreSQL)
- **缓存**: localhost:6379 (Redis)

## 📝 开发工作流

1. **启动开发环境**
   ```bash
   dev-start.bat
   ```

2. **修改代码**
   - 前端: 编辑 `app/frontend/src/` 下的文件
   - 后端: 编辑 `app/backend/` 下的文件

3. **查看效果**
   - 保存文件后等待1-5秒
   - 浏览器自动刷新或API自动重启

4. **调试问题**
   ```bash
   # 查看日志
   docker-compose logs frontend
   docker-compose logs backend
   
   # 重启特定服务
   docker-compose restart frontend
   docker-compose restart backend
   ```

## 🐛 常见问题

### 1. 热更新不生效
```bash
# 完全重新构建
docker-compose down
docker-compose build --no-cache
docker-compose up
```

### 2. 端口被占用
```bash
# 查看端口占用
netstat -an | findstr :3000
netstat -an | findstr :8080

# 修改docker-compose.yml中的端口映射
```

### 3. 文件权限问题 (Linux/Mac)
```bash
# 设置正确的文件权限
chmod -R 755 app/
```

### 4. Node模块问题
```bash
# 重新安装依赖
docker-compose exec frontend npm install
```

## 💡 开发技巧

### 1. 实时日志监控
```bash
# 监控所有服务日志
docker-compose logs -f

# 监控特定服务
docker-compose logs -f frontend
docker-compose logs -f backend
```

### 2. 进入容器调试
```bash
# 进入前端容器
docker-compose exec frontend sh

# 进入后端容器
docker-compose exec backend bash
```

### 3. 数据库操作
```bash
# 连接数据库
docker-compose exec postgres psql -U user -d tutor_db
```

### 4. 清理环境
```bash
# 清理未使用的镜像和容器
docker system prune -f

# 清理卷数据 (慎用!)
docker-compose down -v
```

## ⚠️ 注意事项

- **开发模式**: 当前配置为开发模式，不适用于生产环境
- **性能**: 开发模式会消耗更多资源，用于热重载监听
- **数据持久化**: 数据库数据会持久化存储，卷删除后数据丢失
- **文件同步**: 代码修改实时同步到容器内

## 🔗 相关文档

- [FastAPI文档](https://fastapi.tiangolo.com/)
- [Vue3文档](https://vuejs.org/)
- [Docker Compose文档](https://docs.docker.com/compose/)
- [Vite文档](https://vitejs.dev/) 